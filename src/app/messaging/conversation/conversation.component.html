<div class = "component-wrapper">
    <md-toolbar color = "primary">
        <button md-icon-button [routerLink] = "'../'">
            <md-icon>arrow_back</md-icon>
        </button>
        <span class = "toolbar-heading">
            <span *ngFor = "let participation of conversation?.participations | participating" class = "comma-separated">{{ participation.user.name }}</span>
        </span>
        <span class = "fill-space"></span>
        <button *ngIf = "conversation.group" md-icon-button [routerLink] = "'participants'">
            <md-icon>group</md-icon>
        </button>
    </md-toolbar>
    <md-list class = "conversation">
        <div #conversationWindow>
            <md-list-item *ngFor = "let message of messages" fxFlexAlign = "{{ (isPostedByUser(message) | async) ? 'flex-end' : 'flex-start' }}">
                <img md-list-avatar src = "http://lorempixel.com/40/40">
                <md-card [ngClass] = "{'own-message': isPostedByUser(message) | async}">
                    <md-card-content>{{ message.body }}</md-card-content>
                </md-card>
            </md-list-item>
            <md-list-item *ngIf = "! hasLoadedAll()" fxFlexAlign = "center">
                <button md-raised-button (click) = "loadMore()">Load More</button>
            </md-list-item>
        </div>
    </md-list>
    <md-card class = 'bottom-input'>
        <form (submit) = "sendMessage(message); $event.preventDefault()">
            <div fxLayout = 'row'>
                <md-input-container>
                    <input mdInput [(ngModel)] = "message" name = "message" dividerColor="none" placeholder = "Type message...">
                </md-input-container>
                <button md-icon-button type = "submit" class = "accent-icon-button">
                    <md-icon>send</md-icon>
                </button>
            </div>
        </form>
    </md-card>
</div>

<router-outlet></router-outlet>